xui.widgets.Tip=function(){var a=0,b=xui.util.Dom;return{htmlTmp:'<ul class="xui-tip-ul" id="#uid" onmouseover="xui.widgets.Tip._close(\'#uid\')"><li class="xui-tip-left"></li><li class="xui-tip-bg"><table><tr><td height="25" valign="middle">#msg</td></tr></table></li><li class="xui-tip-right"><span class="xui-tip-btn"></span></li></ul>',show:function(c,d,g,h){if(!g){g=this.htmlTmp}if(!c){alert("[xui.widgets.Tip]\u5bf9\u8c61Id\u4e0d\u5b58\u5728\uff01");return}var f=this.obj=(xui.lang.isString(c))?$(c):c;if(f.style.display=="none"||f.style.visibility=="hidden"){return}var n=xui.util.Dom.getXY(f);if(n[0]==0&&n[1]==0){return}var i=document.createElement("div");i.setAttribute("id","");i.setAttribute("class","xui-tip");i.style.position="absolute";i.style.zIndex="80";i.style.overflow="hidden";i.style.left=(n[0]+2)+"px";i.style.top=(n[1]-35)+"px";var m=$UUID(f.id);xui.widgets.Tip._SRC_ELEMENTS.push(m);if(h){xui.widgets.Tip._SRC_CONFIG.push(h)}else{xui.widgets.Tip._SRC_CONFIG.push({})}if(h&&h.safe){g=g.replace(/#uid/g,m).replace("#msg",xui.util.StringUtil.escapeHTML(d).replace(/&lt;/g,"<").replace(/&gt;/g,">"))}else{g=g.replace(/#uid/g,m).replace("#msg",xui.util.StringUtil.escapeHTML(d).replace(/&lt;br&gt;/g,"<br/>"))}i.innerHTML=xui.util.WinUtil.isIE6()?($Shim()+g):g;document.body.appendChild(i);xui.util.Event.on(f,"mouseover",function(){xui.widgets.Tip._close(m)});xui.util.Event.on(window,"scroll",function(){i.innerHTML=$Shim()+g});xui.util.Event.on(window,"resize",function(){var o;if(b.getStyle(f,"display")=="none"||b.getStyle(f,"visibility")=="hidden"){return}o=xui.util.Dom.getXY(f);if(!o||(o[0]==0&&o[1]==0)){return}i.style.left=(o[0]+2)+"px";i.style.top=(o[1]-20)+"px"});if(!-[1,]){var k=xui.util.Dom.getStyle(i,"width");var e=xui.util.Dom.getStyle(i,"height");var l='<iframe style="filter:alpha(opacity=0); position:absolute; left:0px; top:0px; z-index:-1; width:'+k+";height:"+e+'"></iframe>';i.innerHTML+=l}if(h&&h.autoClose){var j=this;setTimeout(function(){var q=[],p=[];j._close(m);for(var o=0;o<j._SRC_ELEMENTS.length;o++){if(m==j._SRC_ELEMENTS[o]){continue}q.push(j._SRC_ELEMENTS[o]);p.push(j._SRC_CONFIG[o])}j._SRC_ELEMENTS=q;j._SRC_CONFIG=p},h.autoClose)}return i},_close:function(f){var d=$(f);if(!d){return}try{d.parentNode.parentNode.removeChild(d.parentNode)}catch(c){}},_SRC_CONFIG:[],_SRC_ELEMENTS:[],clear:function(){var e=[],d=[];for(var c=0;c<this._SRC_ELEMENTS.length;c++){var f=$(this._SRC_ELEMENTS[c]);if(f&&f!=null){if(this._SRC_CONFIG[c].autoClose){e.push(this._SRC_ELEMENTS[c]);d.push(this._SRC_CONFIG[c]);continue}this._close(f.id)}}this._SRC_ELEMENTS=e;this._SRC_CONFIG=d}}}();xui.widgets.QueryTip={config:{maxWidth:0,maxHeight:0,width:0,height:0},init:function(){this.config.docW=xui.util.Dom.getDocumentWidth();this.config.docH=xui.util.Dom.getDocumentHeight();var b=$T("*");this.obj=[];this.htmlTmp='<div class="xui-tip-qtip-bar"><span class="xui-tip-qtip-btn" onclick="xui.widgets.Tip._close(\'#uid\')"></span></div><div id="#uid" class="xui-tip-qtip-border">#msg</div>';var c=this;for(var a=0;a<b.length;a++){if(b.item(a).getAttribute("querytip")){this.obj.push(b[a]);(function(d,e){e.exec(d)})(b[a],c)}}},exec:function(a){if(a.id==""){a.id=$UUID("qtip")}var b=this;xui.util.Event.on(a,"mouseover",function(){xui.widgets.Tip.clear();var c=xui.widgets.Tip.show(a.id,a.getAttribute("querytip"),b.htmlTmp,{safe:true});b.debugTip(c,a)})},debugTip:function(b,e){b.style.color="#616161";var f=b,a=f.offsetWidth,d=f.offsetHeight;if(this.config.width!=0){a=this.config.width;f.style.width=a+"px";d=f.offsetHeight}if(this.config.height!=0){d=this.config.height;f.style.height=d+"px";a=f.offsetWidth}if(a>this.maxWidth&&this.maxWidth!=0){a=this.config.width;f.style.width=a+"px";d=f.offsetHeight}if(d>this.maxHeight&&this.maxHeight!=0){d=this.maxHeight;f.style.height=d+"px";a=f.offsetWidth;f.style.overflow="auto"}var i=e.offsetHeight,c=e.offsetWidth,g=xui.util.Dom.getXY(e);if(a-c<g[0]&&g[0]+a>this.config.docW){b.style.left=g[0]-(a-c)+"px"}if(g[1]-d>0&&g[1]+i+d>this.config.docH){b.style.top=g[1]-d+"px"}else{b.style.top=g[1]+i+"px"}g=xui.util.Dom.getXY(b);xui.util.Event.on(b,"mouseout",function(l){var k=xui.util.Event.getTarget(l),h=true;var m=l.pageX||l.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft);var j=l.pageY||l.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);if(m<=g[0]||m>=g[0]+a||j<=g[1]||j>=g[1]+d){xui.widgets.Tip.clear();return}})}};xui.util.Event.on(window,"load",$PreloadClass,[["xui-tip-left","xui-tip-bg","xui-tip-right"]]);xui.util.Event.onDOMReady(function(){xui.widgets.QueryTip.init()});
